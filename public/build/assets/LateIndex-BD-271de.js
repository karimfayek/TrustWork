import{a as _,r as i,j as e,c as u}from"./app-jnlzYPnu.js";import{A as L}from"./AuthenticatedLayout-CFg_SBuZ.js";import"./ApplicationLogo-Cq0qfxZU.js";import"./ResponsiveNavLink-mSvN2t_P.js";import"./transition-D0UWB7qs.js";function z(){const{flash:p,users:w}=_().props,{user:F}=_().props.auth,[c,d]=i.useState([]),[t,n]=i.useState({from:new Date().toISOString().split("T")[0],to:new Date().toISOString().split("T")[0],user_id:""}),[I,M]=i.useState(""),[S,h]=i.useState(!1),[x,m]=i.useState(null),[r,g]=i.useState(""),k=s=>{u.post(route("admin.lateAttendances.cancelDeduct",{id:s})).then(l=>{console.log(l.data)}).catch(l=>{console.log(l)}).finally(()=>{d(l=>l.map(o=>o.map(a=>a.id===s?{...a,late_deduct_type:null}:a)))})},A=s=>{m(s),g(""),h(!0)},j=()=>{h(!1),m(null)},C=()=>{console.log("Row:",x),console.log("Discount:",r),u.post(route("admin.lateAttendances.updateDeduct",{id:x.id}),{late_deduct_type:r}).then(s=>{console.log(s.data)}).catch(s=>{console.log(s)}).finally(()=>{d(s=>s.map(l=>l.map(o=>o.id===x.id?{...o,late_deduct_type:r}:o))),console.log("lateAttendances",c)}),j()},D=s=>{s.preventDefault(),u.get(route("admin.lateAttendances.getLateAttendances",{id:t.user_id||9999,from:t.from,to:t.to})).then(l=>{d(l.data),console.log(l.data)})};return e.jsx(L,{children:e.jsxs("div",{className:"p-6 bg-white rounded shadow",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:" التأخيرات"})}),p.success&&e.jsx("div",{className:"mb-4 p-2 bg-green-100 text-green-700 rounded",children:p.success}),e.jsxs("form",{onSubmit:D,className:"bg-white shadow rounded p-4 mb-8 space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-600",children:[" ","عرض مخصص"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{htmlFor:"from",className:"mb-2",children:[" ","اختر الموظف"]}),e.jsxs("select",{className:"border rounded p-2",value:t.user_id,onChange:s=>n({...t,user_id:s.target.value}),children:[e.jsx("option",{value:"",children:"الكل"}),w.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"من تاريخ"}),e.jsx("input",{required:!0,className:"border rounded p-2",type:"date",value:t.from,onChange:s=>n({...t,from:s.target.value})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"الى تاريخ"}),e.jsx("input",{required:!0,className:"border rounded p-2",type:"date",value:t.to,onChange:s=>n({...t,to:s.target.value})})]})]}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"فلتر"})]}),e.jsxs("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{className:"text-right",children:[e.jsx("th",{className:"px-6 py-3 ",children:"الموظف"}),e.jsx("th",{className:"px-6 py-3 ",children:"التاريخ"}),e.jsx("th",{className:"px-6 py-3 ",children:"تسجيل الحضور"}),e.jsx("th",{className:"px-6 py-3 ",children:"الانصراف"}),e.jsx("th",{className:"px-6 py-3 ",children:"خصم"}),e.jsx("th",{className:"px-6 py-3 ",children:"-"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:c&&c.map(s=>{var l,o,a,y,b,f,N,v;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:(l=s[0].user)==null?void 0:l.name}),e.jsxs("td",{className:"px-6 py-4",children:[(o=s[0].check_in_time)==null?void 0:o.split(" ")[0],s[0].project&&((a=s[0].project)==null?void 0:a.name),s[0].visit&&((b=(y=s[0].visit)==null?void 0:y.customer)==null?void 0:b.name),s[0].type==="internal"&&"داخل الشركة",s.type==="external"&&s.customer]}),e.jsxs("td",{className:"px-6 py-4",children:[(f=s[0].check_in_time)==null?void 0:f.split(" ")[1],s[0].in_location!=="غير محدد"&&s[0].in_location!==null&&e.jsx("a",{href:"https://www.google.com/maps?q="+(s==null?void 0:s.in_location),target:"_blank",className:"text-blue-600 underline",children:"لوكيشن"})]}),e.jsxs("td",{className:"px-6 py-4",children:[(N=s[0].check_out_time)==null?void 0:N.split(" ")[1],s[0].out_location!=="غير محدد"&&s[0].out_location!==null&&e.jsx("a",{href:"https://www.google.com/maps?q="+((v=s[0])==null?void 0:v.out_location),target:"_blank",className:"text-blue-600 underline",children:"لوكيشن"})]}),e.jsx("td",{className:"px-6 py-4",children:q[s[0].late_deduct_type]}),e.jsx("td",{className:"px-6 py-4",children:s[0].late_deduct_type==null?e.jsx("button",{onClick:()=>A(s[0]),className:"text-blue-600 underline",children:"خصم"}):e.jsx("button",{onClick:()=>k(s[0].id),className:"text-green-600 underline",children:"الغاء الخصم"})})]},s[0].id)})})]}),S&&e.jsx("div",{style:R,children:e.jsxs("div",{style:T,children:[e.jsx("h3",{children:"اختر نوع الخصم"}),e.jsxs("select",{style:{width:"100%",padding:"8px",marginBottom:"16px"},value:r,onChange:s=>g(s.target.value),children:[e.jsx("option",{value:"",children:"-- اختر --"}),e.jsx("option",{value:"1",children:"ربع يوم"}),e.jsx("option",{value:"2",children:"نصف يوم"}),e.jsx("option",{value:"3",children:"يوم كامل"})]}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",onClick:C,disabled:!r,children:"حفظ"}),e.jsx("button",{className:"bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded",onClick:j,style:{marginLeft:"10px"},children:"إلغاء"})]})]})})]})]})})}const R={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center"},T={background:"#fff",padding:"20px",borderRadius:"8px",width:"300px",textAlign:"center"},q=["لا يوجد","ربع يوم","نصف يوم","يوم كامل"];export{q as deducts,z as default,T as modalStyle,R as overlayStyle};
