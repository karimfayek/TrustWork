import{a as P,r as a,u as q,j as e,b as j}from"./app-Bq7a2C23.js";import{D as M}from"./DeleteButton-Ch5snPH8.js";import{A as F}from"./AuthenticatedLayout-BfBN8nib.js";import L from"./AdvancesList-DuMkq9UJ.js";import"./HandelDelete-DgGQTl2t.js";import"./ApplicationLogo-Dq07tn3e.js";import"./ResponsiveNavLink-DbPuH3OT.js";import"./transition-DnCWSvtv.js";function ae(){const{pendingAdvances:g,users:b,activeProjects:f,advances:R}=P().props,[U,z]=a.useState(null),[B,W]=a.useState(!1),[G,H]=a.useState(null),[J,K]=a.useState(""),[O,Q]=a.useState(""),[T,V]=a.useState(null),{data:o,setData:l,post:A,processing:N,reset:w,errors:r}=q({amount:"",note:"",user_id:"",project_id:"",method:""}),y=t=>{l("user_id",t)},[m,c]=a.useState(g),S=t=>{console.log(t),j.post(route("admin.advance.delete"),{id:t},{preserveScroll:!0,onSuccess:()=>{c(s=>s.filter(n=>n.id!==t)),i(!1),x(""),h(null)}})},[D,i]=a.useState(!1),[p,h]=a.useState(null),[v,x]=a.useState(""),_=t=>{h(t),i(!0)},C=()=>{const t=m.find(s=>s.id===p);j.post(route("admin.advance.status"),{advance_id:p,status:"accepted",amount:t.amount,note:t.note,payment_method:v},{preserveScroll:!0,onSuccess:()=>{c(s=>s.filter(n=>n.id!==p)),i(!1),x(""),h(null)}})},E=(t,s)=>{const n=m.find(d=>d.id===t);j.post(route("admin.advance.status"),{advance_id:t,status:s,amount:n.amount,note:n.note},{preserveScroll:!0,onSuccess:()=>{c(d=>d.filter(u=>u.id!==t))}})},k=(t,s,n)=>{c(d=>d.map((u,I)=>I===t?{...u,[s]:n}:u))};return e.jsxs(F,{children:[e.jsx(L,{advances:m,type:"pending",onDelete:S,onApprove:_,onReject:E,onUpdate:k,admin:!0}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-center px-4 gap-4",children:e.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-2xl mt-4  border border-gray-200 mx-auto",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù‡Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),console.log("postadvance"),A(route("admin.advance.store"),{preserveScroll:!0,onSuccess:()=>w()})},children:[e.jsxs("select",{name:"user_id",className:"w-full border p-2 mb-2",onChange:t=>y(t.target.value),children:[e.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("input",{required:!0,type:"number",onWheel:t=>t.target.blur(),placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº",value:o.amount,onChange:t=>l("amount",t.target.value),className:"w-full border p-2 mb-2"}),r.amount&&e.jsx("div",{className:"text-red-600",children:r.amount}),e.jsx("input",{required:!0,type:"text",placeholder:"Ø§Ù„ØºØ±Ø¶ Ù…Ù† Ø§Ù„Ø¹Ù‡Ø¯Ø©",value:o.note,onChange:t=>l("note",t.target.value),className:"w-full border p-2 mb-2"}),r.note&&e.jsx("div",{className:"text-red-600",children:r.note}),e.jsxs("select",{required:!0,value:o.project_id,onChange:t=>l("project_id",t.target.value),className:"w-full border p-2 mb-2",children:[e.jsx("option",{value:"",children:"Ù„Ù„Ù…Ø´Ø±ÙˆØ¹"}),f.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id)),e.jsx("option",{value:"null",children:"Ø§Ø®Ø±Ù‰"})]}),e.jsxs("select",{required:!0,className:"w-full p-2 border rounded mb-4",value:o.method,onChange:t=>l("method",t.target.value),children:[e.jsx("option",{value:"",children:"-- Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© --"}),e.jsx("option",{value:"cash",children:"ÙƒØ§Ø´"}),e.jsx("option",{value:"wallet",children:"Ù…Ø­ÙØ¸Ø©"}),e.jsx("option",{value:"insta",children:"Ø§Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ"}),e.jsx("option",{value:"bank",children:"ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ"})]}),e.jsx("button",{type:"submit",disabled:N,className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Ø­ÙØ¸ Ø§Ù„Ø¹Ù‡Ø¯Ø©"})]})]})}),e.jsx("h2",{className:"text-2xl font-semibold mb-2 border-t underline",children:"Ø§Ù„Ø¹Ù‡Ø¯ Ø§Ù„Ù…ÙØ³ØªÙ„Ù…Ø©"}),b.map(t=>t.advances.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl font-bold mb-2",children:t.name}),Array.isArray(t.advances)&&t.advances.length>0?e.jsx("ul",{className:"bg-white p-4 rounded shadow",children:t.advances.map((s,n)=>{var d;return e.jsx("li",{className:"border-b py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:["ğŸ“…"," ",s.given_at||s.status]}),e.jsxs("div",{children:["ğŸ’µ ",s.amount," Ø¬.Ù…"]}),e.jsxs("div",{children:["ğŸ’¸ ",s.method," "]}),e.jsxs("div",{children:["ğŸ“ ",s.note]}),e.jsxs("div",{children:["ğŸ“"," ",((d=s.project)==null?void 0:d.name)||"Ø§Ø®Ø±Ù‰"]})]}),e.jsx("div",{children:e.jsx(M,{id:s.id,routeName:"admin.advance.delete"})})]})},n)})}):e.jsx("p",{className:"text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ù„ÙÙŠØ§Øª"})]},t.id))]}),D&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù‡Ø¯Ø©"}),e.jsxs("select",{className:"w-full p-2 border rounded mb-4",value:v,onChange:t=>x(t.target.value),children:[e.jsx("option",{value:"",children:"-- Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© --"}),e.jsx("option",{value:"cash",children:"ÙƒØ§Ø´"}),e.jsx("option",{value:"wallet",children:"Ù…Ø­ÙØ¸Ø©"}),e.jsx("option",{value:"insta",children:"Ø§Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ"}),e.jsx("option",{value:"bank",children:"ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>i(!1),className:"bg-gray-200 px-4 py-2 rounded",children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx("button",{onClick:C,disabled:!v,className:"bg-green-500 text-white px-4 py-2 rounded",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©"})]})]})})]})}export{ae as default};
