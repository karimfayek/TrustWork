import{r as o,j as e,b as g}from"./app-BWDpdEng.js";import{U as b}from"./UserLayout-nKjw-9RI.js";import{u as f}from"./useGeolocation-C8U-cSoH.js";import"./ApplicationLogo-BvvK1nc1.js";import"./ResponsiveNavLink-CXDb9oSx.js";import"./transition-C-4CbgO8.js";function S({userId:h,atts:u}){const[m,t]=o.useState(!1),{error:n,getLocation:i}=f(),[x,p]=o.useState(null);o.useEffect(()=>{i()},[i]),o.useEffect(()=>{n&&p(n)},[n]);const[l,c]=o.useState({user_id:h,project:"",inOut:"",type:"internal",customer:"",customer_id:""}),j=async(s,d)=>{if(s.preventDefault(),t(!1),!navigator.geolocation){t(!1),alert("المتصفح لا يدعم تحديد الموقع");return}const r=await i();console.log(r);const a={...l,customer:l.type!=="external"?"":l.customer,location:`${r.latitude},${r.longitude}`};g.post(route("check.manual"),a,{preserveState:!0,replace:!0,onSuccess:()=>t(!1)}),console.log("Sending payload: ",a)};return e.jsxs(b,{children:[x&&e.jsxs("p",{className:"text-red-500",children:["Error: ",x]}),e.jsxs("form",{onSubmit:j,className:"bg-white shadow rounded p-4 mb-8 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-600",children:"تسجيل الحضور والانصراف"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"اختر المكان"}),e.jsxs("select",{value:l.type,required:!0,onChange:s=>c({...l,type:s.target.value}),className:"border rounded p-2",children:[e.jsx("option",{value:"internal",children:"داخل الشركة"}),e.jsx("option",{value:"external",children:"خارج الشركة"})]})]}),l.type==="external"&&e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"اسم العميل"}),e.jsx("input",{type:"text",value:l.customer,required:!0,className:"border rounded p-2",onChange:s=>c({...l,customer:s.target.value})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"النوع"}),e.jsxs("select",{required:!0,className:"border rounded p-2",value:l.inOut,onChange:s=>c({...l,inOut:s.target.value}),children:[e.jsx("option",{value:"",children:"اختر "}),e.jsx("option",{value:"in",children:"حضور"}),e.jsx("option",{value:"out",children:"انصراف"})]})]})]}),e.jsx("button",{disabled:m,type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-25",children:m?"جار التسجيل":"تسجيل"})]}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 mt-6",children:e.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[" ","الحضور والانصراف"]})}),e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{className:"text-right",children:[e.jsx("th",{className:"px-6 py-3 ",children:"المكان"}),e.jsx("th",{className:"px-6 py-3 ",children:"تسجيل الحضور"}),e.jsx("th",{className:"px-6 py-3 ",children:"الانصراف"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:u&&u.map(s=>{var d,r,a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[s.project&&((d=s.project)==null?void 0:d.name),s.visit&&((a=(r=s.visit)==null?void 0:r.customer)==null?void 0:a.name),s.type==="internal"&&"داخل الشركة",s.type==="external"&&s.customer]}),e.jsxs("td",{className:"px-6 py-4",children:[s.check_in_time,s.in_location!=="غير محدد"&&s.in_location!==null&&e.jsx("a",{href:"https://www.google.com/maps?q="+(s==null?void 0:s.in_location),target:"_blank",className:"text-blue-600 underline",children:"لوكيشن"})]}),e.jsxs("td",{className:"px-6 py-4",children:[s.check_out_time,s.out_location!=="غير محدد"&&s.out_location!==null&&e.jsx("a",{href:"https://www.google.com/maps?q="+(s==null?void 0:s.out_location),target:"_blank",className:"text-blue-600 underline",children:"لوكيشن"})]})]},s.id)})})]})})]})]})}export{S as default};
