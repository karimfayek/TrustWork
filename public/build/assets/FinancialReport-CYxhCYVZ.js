import{r as g,j as e,R as m}from"./app-D9iPPawn.js";import u from"./ReportLayout-DHaHUn8P.js";import"./AuthenticatedLayout-DIesHiZa.js";import"./ApplicationLogo-KeqFsUIh.js";import"./ResponsiveNavLink-CftO751p.js";import"./transition-Ctt6iwUW.js";function R({users:f,projects:n}){const[h,N]=g.useState("all");return console.log(n,"projects"),e.jsx(u,{children:e.jsxs("div",{className:"bg-white max-w-6xl mx-auto px-4 py-6 space-y-10",children:[e.jsx("h1",{className:"text-2xl font-bold text-center",children:"تقرير العهد المالية"}),e.jsxs("div",{className:"mb-4 print:hidden",children:[e.jsx("label",{htmlFor:"projectFilter",className:"mr-2 font-semibold",children:"فلترة حسب المشروع:"}),e.jsxs("select",{id:"projectFilter",value:h,onChange:s=>N(s.target.value),className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"all",children:"الكل"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"العهدة المصروفة للمشروعات"}),e.jsx("div",{className:"overflow-x-auto border rounded shadow",children:e.jsxs("table",{className:"min-w-full table-auto text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"اسم المشروع"}),e.jsx("th",{className:"p-2 border",children:"التاريخ"}),e.jsx("th",{className:"p-2 border",children:"القيمة (جنيه)"}),e.jsx("th",{className:"p-2 border",children:" للموظف "})]})}),e.jsx("tbody",{children:n.filter(s=>h==="all"||s.id==h).map((s,x)=>{var i;let l=0,o=0;return e.jsxs(m.Fragment,{children:[e.jsx("tr",{className:"bg-gray-200",children:e.jsx("td",{colSpan:4,className:"font-bold p-2 text-2xl text-green-600",children:s.name})}),(i=s.advances)==null?void 0:i.map((r,a)=>{var t,d,b;const j=((t=r.expenses)==null?void 0:t.reduce((c,p)=>c+p.amount,0))||0;return l+=Number(r.amount),o+=Number(j),e.jsxs(m.Fragment,{children:[e.jsx("tr",{className:"bg-gray-100",children:e.jsxs("td",{className:"p-2 border font-semibold",colSpan:4,children:[a+1," ","- عهدة بتاريخ"," ",r.given_at," ","- بقيمة"," ",r.amount.toLocaleString()," ","جنيه -"," ",(d=r.user)==null?void 0:d.name]})}),((b=r.expenses)==null?void 0:b.length)>0?r.expenses.map((c,p)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 border"}),e.jsx("td",{className:"p-2 border",children:c.spent_at}),e.jsx("td",{className:"p-2 border",children:c.amount.toLocaleString()}),e.jsx("td",{className:"p-2 border",children:c.description})]},p)):e.jsx("tr",{children:e.jsx("td",{className:"p-2 border text-gray-500",colSpan:4,children:"لا توجد مصروفات لهذه العهدة"})})]},a)}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-2 border",colSpan:2,children:"إجمالي العهد"}),e.jsxs("td",{className:"p-2 border",colSpan:2,children:[l.toLocaleString()," ","جنيه"]})]}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-2 border",colSpan:2,children:"إجمالي المصروفات"}),e.jsxs("td",{className:"p-2 border",colSpan:2,children:[o.toLocaleString()," ","جنيه"]})]})]},x)})})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"المصروفات"}),e.jsx("div",{className:"overflow-x-auto border rounded shadow",children:e.jsxs("table",{className:"min-w-full table-auto text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"اسم المشروع"}),e.jsx("th",{className:"p-2 border",children:"القيمة (جنيه)"}),e.jsx("th",{className:"p-2 border",children:"الموظف"}),e.jsx("th",{className:"p-2 border",children:"اضيفت بواسطه"}),e.jsx("th",{className:"p-2 border",children:"الإيصال"}),e.jsx("th",{className:"p-2 border",children:"التاريخ"})]})}),e.jsx("tbody",{children:n.map((s,x)=>{var l;return e.jsx(m.Fragment,{children:(l=s.advances)==null?void 0:l.map((o,i)=>{var r;return e.jsx(m.Fragment,{children:(r=o.expenses)==null?void 0:r.map((a,j)=>{var t,d;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 border",children:s.name}),e.jsx("td",{className:"p-2 border",children:a.amount.toLocaleString()}),e.jsx("td",{className:"p-2 border",children:(t=a.user)==null?void 0:t.name}),e.jsx("td",{className:"p-2 border",children:(d=a.by)==null?void 0:d.name}),e.jsx("td",{className:"p-2 border",children:e.jsx("a",{href:"/storage/"+a.file_path,target:"_blank",rel:"noopener noreferrer",children:"إيصال"})}),e.jsx("td",{className:"p-2 border",children:a.spent_at})]},j)})},i)})},x)})})]})})]})]})})}export{R as default};
