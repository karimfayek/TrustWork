import{r as h,a as t,j as e}from"./app-DM1yzmg1.js";function L({user:s,forUser:n=!1,totalAdvance:r,totalExpense:i,remaining:q}){var u,g,N,y;const[l,f]=h.useState({}),[v,w]=h.useState(null),o=t().props.auth.user,m=(o==null?void 0:o.rolesnames)??[];Number(l==null?void 0:l.absenceDays)*Number(Number((u=s.salary)==null?void 0:u.final_salary)/30);const b=(l==null?void 0:l.month_days)-(l==null?void 0:l.absenceDays),a=Number(((g=s.salary)==null?void 0:g.final_salary)??0)/(l==null?void 0:l.month_days)*Number(b??0),p=Number(((N=s.salary)==null?void 0:N.final_salary)??0)-a;console.log(b,"realAttDayes");const F=Number(Number((y=s.salary)==null?void 0:y.final_salary)+Number(l==null?void 0:l.rewards)-p+Number(l==null?void 0:l.transportaionFees)-Number(l.lostCostThisMonth)-Number(l.deductions)-Number(l.basics)-Number(l.loans)-Number(l.remaining)).toFixed(2),[c,S]=h.useState(()=>{const d=new Date,x=new Date(d.getFullYear(),d.getMonth(),1),j=n?new Date(d):new Date(d.getFullYear(),d.getMonth()+1,0);return{from:x.toLocaleDateString("en-CA"),to:j.toLocaleDateString("en-CA")}});return h.useEffect(()=>{const d=async()=>{try{const j=await(await fetch(`/calc-emp-att/${s.id}?from=${c.from}&to=${c.to}`)).json();f(j)}catch(x){console.error("Error fetching attendance data:",x)}};c.from&&c.to&&d()},[c,s.id]),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-gray-100 mb-12 p-5 shadow-sm ",children:[e.jsx("h2",{className:"bg-white p-5 text-2xl text-center underline",children:s.name}),!n&&e.jsx(_,{month:v,setMonth:w,filters:c,setFilters:S}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[!n&&["admin","acc"].some(d=>m==null?void 0:m.includes(d))&&o.email!=="sherok@trustits.net"&&e.jsxs(e.Fragment,{children:[e.jsx(C,{user:s,attData:l}),e.jsx(T,{attData:l,absenceScore:p}),e.jsx(A,{deserved:F})]}),e.jsx(M,{attData:l}),e.jsx(E,{attData:l}),e.jsx(k,{attData:l})]})]})})}const _=({filters:s,setFilters:n})=>e.jsx("div",{children:e.jsxs("form",{className:"bg-white shadow rounded p-4 mb-8 space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-600",children:[" ","عرض نتائج"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"من تاريخ"}),e.jsx("input",{required:!0,className:"border rounded p-2",type:"date",value:s.from,onChange:r=>n({...s,from:r.target.value})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"الى تاريخ"}),e.jsx("input",{required:!0,className:"border rounded p-2",type:"date",value:s.to,onChange:r=>n({...s,to:r.target.value})})]})]})]})}),C=({user:s,attData:n})=>{var r;return e.jsxs("div",{className:"bg-white p-4 shadow sm:rounded-lg sm:p-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"استحقاقات"}),e.jsx("hr",{}),e.jsxs("div",{children:[e.jsx("b",{children:"المرتب"}),e.jsx("p",{className:"text-green-800",children:Number((r=s.salary)==null?void 0:r.final_salary)})]}),e.jsxs("div",{children:[e.jsx("b",{children:"الانتقالات"}),e.jsx("p",{className:"text-green-800",children:Number(n==null?void 0:n.transportaionFees).toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("b",{children:"المكافئات"}),e.jsx("p",{className:"text-green-800",children:Number(n==null?void 0:n.rewards).toFixed(2)})]})]})},T=({attData:s,absenceScore:n})=>e.jsxs("div",{className:"bg-white p-4 shadow sm:rounded-lg sm:p-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"استقطاعات"}),e.jsx("hr",{}),e.jsxs("div",{children:[e.jsx("b",{children:"استقطاعات اساسيه من الراتب"}),e.jsx("p",{className:"text-red-800",children:Number(s==null?void 0:s.deductions).toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("b",{children:"   جزاءات"}),e.jsx("p",{className:"text-red-800",children:Number(s==null?void 0:s.basics).toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("b",{children:"غياب"}),e.jsx("p",{className:"text-red-800",children:e.jsx("span",{children:n})})]}),e.jsxs("div",{children:[e.jsx("b",{children:"مفقودات"}),e.jsx("p",{className:"text-red-800",children:e.jsx("span",{children:s.lostCostThisMonth})})]}),e.jsxs("div",{children:[e.jsx("b",{children:"عهد - مصروفات"}),e.jsx("p",{className:"text-red-800",children:s==null?void 0:s.remaining})]}),e.jsxs("div",{children:[e.jsx("b",{children:" سلف"}),e.jsx("p",{className:"text-red-800",children:s==null?void 0:s.loans})]})]}),A=({deserved:s})=>e.jsxs("div",{className:"bg-white shadow sm:rounded-lg sm:p-8 border mt-4 p-2.5 text-center",children:[e.jsx("b",{className:"border p-1.5",children:"المرتب المستحق"}),e.jsxs("p",{dir:"ltr",className:`font-bold mt-3 text-2xl ${s<1?"text-red-500":"text-green-500"}`,children:[e.jsx("br",{}),s]})]}),M=({attData:s})=>e.jsxs("div",{className:"bg-white p-4 shadow sm:rounded-lg sm:p-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"الحضور"}),e.jsx("hr",{}),e.jsx("b",{children:"النسبة المئوية للحضور"}),e.jsxs("p",{children:[s==null?void 0:s.attendance_percentage," %"]}),e.jsxs("div",{children:[e.jsx("b",{children:"عدد ايام الحضور المتأخر"}),e.jsx("p",{children:s==null?void 0:s.late_days})]}),e.jsxs("div",{children:[e.jsx("b",{children:"عدد ايام الحضور خلال الشهر"}),e.jsx("p",{children:s==null?void 0:s.att_days})]}),e.jsxs("div",{children:[e.jsx("b",{children:"عدد ايام الغياب خلال الشهر"}),e.jsx("p",{children:s==null?void 0:s.absenceDays})]})]}),E=({attData:s})=>e.jsxs("div",{className:"bg-white p-4 shadow sm:rounded-lg sm:p-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"المهام"}),e.jsx("hr",{}),e.jsx("b",{children:"اجمالى المهام المسندة خلال الشهر"}),e.jsx("p",{children:s==null?void 0:s.alltasks}),e.jsxs("div",{children:[e.jsx("b",{children:"المهام المكتمله"}),e.jsx("p",{children:s==null?void 0:s.tasksCompleted})]}),e.jsxs("div",{children:[e.jsx("b",{children:"النسبه المئوية لاكمال المهام"}),e.jsxs("p",{children:[s==null?void 0:s.completedTasksPercentage," %"]})]})]}),k=({attData:s})=>{var n;return e.jsxs("div",{className:"bg-white p-4 shadow sm:rounded-lg sm:p-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"الادوات"}),e.jsx("hr",{}),e.jsx("b",{children:"ادوات معه:"}),e.jsx("ul",{className:"inline-flex flex-wrap",children:s.assignments&&s.assignments.map(r=>{var i;return r.status==="assigned"&&e.jsxs("li",{className:"bg-[#b7ffb7] p-1.5 m-2",children:[(i=r.tool)==null?void 0:i.name," * ",r.quantity]},r.id)})}),e.jsxs("div",{children:[e.jsx("b",{children:"ادوات مفقودة:"}),((n=s.lostThismonth)==null?void 0:n.length)<1&&e.jsx("p",{className:"bg-[#FF2D20]/10 p-1.5 m-2",children:"لا يوجد"}),e.jsx("ul",{className:"inline-flex flex-wrap",children:s.lostThismonth&&s.lostThismonth.map(r=>{var i;return e.jsxs("li",{className:"bg-[#FF2D20]/10 p-1.5 m-2",children:[(i=r.tool)==null?void 0:i.name," * ",r.quantity," * ",r.tool.estimated_value," ج"]},r.id)})})]}),e.jsxs("div",{children:[e.jsx("b",{children:"قيمه الادوات المفقودة"}),e.jsxs("p",{children:[s.lostCostThisMonth," ج"]})]})]})};export{L as default};
