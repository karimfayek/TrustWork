import{a as N,r as a,j as e,c as x}from"./app-Jg-29AV2.js";import{A as D}from"./AuthenticatedLayout-DomzFhWM.js";import"./ApplicationLogo-CosfqbDy.js";import"./ResponsiveNavLink-BJxzDtRs.js";import"./transition-DJIktv-M.js";function B(){const{flash:h,users:v}=N().props,{user:T}=N().props.auth,[p,d]=a.useState([]),[o,n]=a.useState({from:new Date().toISOString().split("T")[0],to:new Date().toISOString().split("T")[0],user_id:""}),[q,E]=a.useState(""),[w,m]=a.useState(!1),[u,g]=a.useState(null),[c,j]=a.useState(""),_=s=>{x.post(route("admin.lateAttendances.cancelDeduct",{id:s})).then(l=>{console.log(l.data)}).catch(l=>{console.log(l)}).finally(()=>{d(l=>{const t={...l};return Object.keys(t).forEach(i=>{t[i]=t[i].map(r=>r.id===s?{...r,late_deduct_type:null}:r)}),t})})},S=s=>{g(s),j(""),m(!0)},y=()=>{m(!1),g(null)},k=()=>{console.log("Row:",u),console.log("Discount:",c),x.post(route("admin.lateAttendances.updateDeduct",{id:u.id}),{late_deduct_type:c}).then(s=>{console.log(s.data)}).catch(s=>{console.log(s)}).finally(()=>{d(s=>{const l={...s};return Object.keys(l).forEach(t=>{l[t]=l[t].map(i=>i.id===u.id?{...i,late_deduct_type:c}:i)}),l})}),y()},A=s=>{s.preventDefault(),x.get(route("admin.lateAttendances.getLateAttendances",{id:o.user_id||9999,from:o.from,to:o.to})).then(l=>{d(l.data),console.log(l.data)})};return e.jsx(D,{children:e.jsxs("div",{className:"p-6 bg-white rounded shadow",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:" التأخيرات"})}),h.success&&e.jsx("div",{className:"mb-4 p-2 bg-green-100 text-green-700 rounded",children:h.success}),e.jsxs("form",{onSubmit:A,className:"bg-white shadow rounded p-4 mb-8 space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-600",children:[" ","عرض مخصص"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("label",{htmlFor:"from",className:"mb-2",children:[" ","اختر الموظف"]}),e.jsxs("select",{className:"border rounded p-2",value:o.user_id,onChange:s=>n({...o,user_id:s.target.value}),children:[e.jsx("option",{value:"",children:"الكل"}),v.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"من تاريخ"}),e.jsx("input",{required:!0,className:"border rounded p-2",type:"date",value:o.from,onChange:s=>n({...o,from:s.target.value})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{htmlFor:"from",className:"mb-2",children:"الى تاريخ"}),e.jsx("input",{required:!0,className:"border rounded p-2",type:"date",value:o.to,onChange:s=>n({...o,to:s.target.value})})]})]}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"فلتر"})]}),e.jsxs("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{className:"text-right",children:[e.jsx("th",{className:"px-6 py-3 ",children:"الموظف"}),e.jsx("th",{className:"px-6 py-3 ",children:"التاريخ"}),e.jsx("th",{className:"px-6 py-3 ",children:"تسجيل الحضور"}),e.jsx("th",{className:"px-6 py-3 ",children:"الانصراف"}),e.jsx("th",{className:"px-6 py-3 ",children:"خصم"}),e.jsx("th",{className:"px-6 py-3 ",children:"-"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:p&&p.map(s=>{var l,t,i,r,b,f;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:(l=s.user)==null?void 0:l.name}),e.jsxs("td",{className:"px-6 py-4",children:[s.check_in_time.split(" ")[0],s.project&&((t=s.project)==null?void 0:t.name),s.visit&&((r=(i=s.visit)==null?void 0:i.customer)==null?void 0:r.name),s.type==="internal"&&"داخل الشركة",s.type==="external"&&s.customer]}),e.jsxs("td",{className:"px-6 py-4",children:[(b=s.check_in_time)==null?void 0:b.split(" ")[1],s.in_location!=="غير محدد"&&s.in_location!==null&&e.jsx("a",{href:"https://www.google.com/maps?q="+(s==null?void 0:s.in_location),target:"_blank",className:"text-blue-600 underline",children:"لوكيشن"})]}),e.jsxs("td",{className:"px-6 py-4",children:[(f=s.check_out_time)==null?void 0:f.split(" ")[1],s.out_location!=="غير محدد"&&s.out_location!==null&&e.jsx("a",{href:"https://www.google.com/maps?q="+(s==null?void 0:s.out_location),target:"_blank",className:"text-blue-600 underline",children:"لوكيشن"})]}),e.jsx("td",{className:"px-6 py-4",children:R[s.late_deduct_type]}),e.jsx("td",{className:"px-6 py-4",children:s.late_deduct_type==null?e.jsx("button",{onClick:()=>S(s),className:"text-blue-600 underline",children:"خصم"}):e.jsx("button",{onClick:()=>_(s.id),className:"text-green-600 underline",children:"الغاء الخصم"})})]},s.id)})})]}),w&&e.jsx("div",{style:C,children:e.jsxs("div",{style:L,children:[e.jsx("h3",{children:"اختر نوع الخصم"}),e.jsxs("select",{style:{width:"100%",padding:"8px",marginBottom:"16px"},value:c,onChange:s=>j(s.target.value),children:[e.jsx("option",{value:"",children:"-- اختر --"}),e.jsx("option",{value:"1",children:"ربع يوم"}),e.jsx("option",{value:"2",children:"نصف يوم"}),e.jsx("option",{value:"3",children:"يوم كامل"})]}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("button",{className:"bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",onClick:k,disabled:!c,children:"حفظ"}),e.jsx("button",{className:"bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded",onClick:y,style:{marginLeft:"10px"},children:"إلغاء"})]})]})})]})]})})}const C={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center"},L={background:"#fff",padding:"20px",borderRadius:"8px",width:"300px",textAlign:"center"},R=["لا يوجد","ربع يوم","نصف يوم","يوم كامل"];export{R as deducts,B as default,L as modalStyle,C as overlayStyle};
