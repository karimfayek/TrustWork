import{r as p,j as e,R as m}from"./app-BELKTjV-.js";import N from"./ReportLayout-CP35GThg.js";import"./AuthenticatedLayout-CCngwH8r.js";import"./ApplicationLogo-DqDhmsPc.js";import"./ResponsiveNavLink-D6BvRnI1.js";import"./transition-DTTrYAim.js";function F({users:g,projects:n}){const[h,b]=p.useState("all");return console.log(n,"projects"),e.jsx(N,{children:e.jsxs("div",{className:"bg-white max-w-6xl mx-auto px-4 py-6 space-y-10",children:[e.jsx("h1",{className:"text-2xl font-bold text-center",children:"تقرير العهد المالية"}),e.jsxs("div",{className:"mb-4 print:hidden",children:[e.jsx("label",{htmlFor:"projectFilter",className:"mr-2 font-semibold",children:"فلترة حسب المشروع:"}),e.jsxs("select",{id:"projectFilter",value:h,onChange:s=>b(s.target.value),className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"all",children:"الكل"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"العهدة المصروفة للمشروعات"}),e.jsx("div",{className:"overflow-x-auto border rounded shadow",children:e.jsxs("table",{className:"min-w-full table-auto text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"اسم المشروع"}),e.jsx("th",{className:"p-2 border",children:"التاريخ"}),e.jsx("th",{className:"p-2 border",children:"القيمة (جنيه)"}),e.jsx("th",{className:"p-2 border",children:" للموظف "})]})}),e.jsx("tbody",{children:n.filter(s=>h==="all"||s.id==h).map((s,x)=>{var o;let t=0;return e.jsxs(m.Fragment,{children:[e.jsx("tr",{className:"bg-gray-200",children:e.jsx("td",{colSpan:4,className:"font-bold p-2 text-2xl text-green-600",children:s.name})}),(o=s.advances)==null?void 0:o.map((r,d)=>{var a,i,c;return(a=r.expenses)!=null&&a.reduce((l,j)=>l+j.amount,0),t+=Number(r.amount),e.jsxs(m.Fragment,{children:[e.jsx("tr",{className:"bg-gray-100",children:e.jsxs("td",{className:"p-2 border font-semibold",colSpan:4,children:[d+1," ","- عهدة بتاريخ"," ",r.given_at," ","- بقيمة"," ",r.amount.toLocaleString()," ","جنيه -"," ",(i=r.user)==null?void 0:i.name]})}),((c=r.expenses)==null?void 0:c.length)>0?r.expenses.map((l,j)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 border"}),e.jsx("td",{className:"p-2 border",children:l.spent_at}),e.jsx("td",{className:"p-2 border",children:l.amount.toLocaleString()}),e.jsx("td",{className:"p-2 border",children:l.description})]},j)):e.jsx("tr",{children:e.jsx("td",{className:"p-2 border text-gray-500",colSpan:4,children:"لا توجد مصروفات لهذه العهدة"})})]},d)}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-2 border",colSpan:2,children:"إجمالي العهد"}),e.jsxs("td",{className:"p-2 border",colSpan:2,children:[t.toLocaleString()," ","جنيه"]})]}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-2 border",colSpan:2,children:"إجمالي المصروفات"}),e.jsxs("td",{className:"p-2 border",colSpan:2,children:[s.total_expenses," ","جنيه"]})]})]},x)})})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"المصروفات"}),e.jsx("div",{className:"overflow-x-auto border rounded shadow",children:e.jsxs("table",{className:"min-w-full table-auto text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"اسم المشروع"}),e.jsx("th",{className:"p-2 border",children:"القيمة (جنيه)"}),e.jsx("th",{className:"p-2 border",children:"الموظف"}),e.jsx("th",{className:"p-2 border",children:"اضيفت بواسطه"}),e.jsx("th",{className:"p-2 border",children:"الإيصال"}),e.jsx("th",{className:"p-2 border",children:"التاريخ"})]})}),e.jsx("tbody",{children:n.map((s,x)=>{var t;return e.jsx(m.Fragment,{children:(t=s.advances)==null?void 0:t.map((o,r)=>{var d;return e.jsx(m.Fragment,{children:(d=o.expenses)==null?void 0:d.map((a,i)=>{var c,l;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 border",children:s.name}),e.jsx("td",{className:"p-2 border",children:a.amount.toLocaleString()}),e.jsx("td",{className:"p-2 border",children:(c=a.user)==null?void 0:c.name}),e.jsx("td",{className:"p-2 border",children:(l=a.by)==null?void 0:l.name}),e.jsx("td",{className:"p-2 border",children:e.jsx("a",{href:"/storage/"+a.file_path,target:"_blank",rel:"noopener noreferrer",children:"إيصال"})}),e.jsx("td",{className:"p-2 border",children:a.spent_at})]},i)})},r)})},x)})})]})})]})]})})}export{F as default};
