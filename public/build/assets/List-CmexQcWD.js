import{a as M,u as E,r as u,j as e,b as j}from"./app-TldEGNiL.js";import{D as L}from"./DeleteButton-Dfz3T8X1.js";import{A as I}from"./AuthenticatedLayout-CATPFx7X.js";import R from"./AdvancesList-BmDsv8js.js";import"./HandelDelete-B4UAkT6B.js";import"./ApplicationLogo-CcI4PQpl.js";import"./ResponsiveNavLink-BasFm6VB.js";import"./transition-CPX1VhGX.js";function K(){const{pendingAdvances:g,users:b,activeProjects:f}=M().props,{data:l,setData:d,post:N,processing:w,reset:A,errors:o}=E({amount:"",note:"",user_id:"",project_id:"",method:""}),y=t=>{d("user_id",t)},[m,r]=u.useState(g),S=t=>{console.log(t),j.post(route("admin.advance.delete"),{id:t},{preserveScroll:!0,onSuccess:()=>{r(s=>s.filter(a=>a.id!==t)),c(!1),x(""),h(null)}})},[_,c]=u.useState(!1),[p,h]=u.useState(null),[v,x]=u.useState(""),C=t=>{h(t),c(!0)},D=()=>{const t=m.find(s=>s.id===p);j.post(route("admin.advance.status"),{advance_id:p,status:"accepted",amount:t.amount,note:t.note,payment_method:v},{preserveScroll:!0,onSuccess:()=>{r(s=>s.filter(a=>a.id!==p)),c(!1),x(""),h(null)}})},k=(t,s)=>{const a=m.find(n=>n.id===t);j.post(route("admin.advance.status"),{advance_id:t,status:s,amount:a.amount,note:a.note},{preserveScroll:!0,onSuccess:()=>{r(n=>n.filter(i=>i.id!==t))}})},P=(t,s,a)=>{r(n=>n.map((i,q)=>q===t?{...i,[s]:a}:i))};return e.jsxs(I,{children:[e.jsx(R,{advances:m,type:"pending",onDelete:S,onApprove:C,onReject:k,onUpdate:P,admin:!0}),e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white p-4 rounded shadow max-w-2xl mt-4  border border-gray-200 mx-auto",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù‡Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),console.log("postadvance"),N(route("admin.advance.store"),{preserveScroll:!0,onSuccess:()=>A()})},children:[e.jsxs("select",{name:"user_id",className:"w-full border p-2 mb-2",onChange:t=>y(t.target.value),children:[e.jsx("option",{value:"",children:"Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¸Ù"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("input",{required:!0,type:"number",onWheel:t=>t.target.blur(),placeholder:"Ø§Ù„Ù…Ø¨Ù„Øº",value:l.amount,onChange:t=>d("amount",t.target.value),className:"w-full border p-2 mb-2"}),o.amount&&e.jsx("div",{className:"text-red-600",children:o.amount}),e.jsx("input",{required:!0,type:"text",placeholder:"Ø§Ù„ØºØ±Ø¶ Ù…Ù† Ø§Ù„Ø¹Ù‡Ø¯Ø©",value:l.note,onChange:t=>d("note",t.target.value),className:"w-full border p-2 mb-2"}),o.note&&e.jsx("div",{className:"text-red-600",children:o.note}),e.jsxs("select",{required:!0,value:l.project_id,onChange:t=>d("project_id",t.target.value),className:"w-full border p-2 mb-2",children:[e.jsx("option",{value:"",children:"Ù„Ù„Ù…Ø´Ø±ÙˆØ¹"}),f.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id)),e.jsx("option",{value:"null",children:"Ø§Ø®Ø±Ù‰"})]}),e.jsxs("select",{required:!0,className:"w-full p-2 border rounded mb-4",value:l.method,onChange:t=>d("method",t.target.value),children:[e.jsx("option",{value:"",children:"-- Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© --"}),e.jsx("option",{value:"cash",children:"ÙƒØ§Ø´"}),e.jsx("option",{value:"wallet",children:"Ù…Ø­ÙØ¸Ø©"}),e.jsx("option",{value:"insta",children:"Ø§Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ"}),e.jsx("option",{value:"bank",children:"ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ"})]}),e.jsx("button",{type:"submit",disabled:w,className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Ø­ÙØ¸ Ø§Ù„Ø¹Ù‡Ø¯Ø©"})]})]}),e.jsx("h2",{className:"text-2xl font-semibold mb-2 border-t underline",children:"Ø§Ù„Ø¹Ù‡Ø¯ Ø§Ù„Ù…ÙØ³ØªÙ„Ù…Ø©"}),b.map(t=>t.advances.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl font-bold mb-2",children:t.name}),Array.isArray(t.advances)&&t.advances.length>0?e.jsx("ul",{className:"bg-white p-4 rounded shadow",children:t.advances.map((s,a)=>{var n;return e.jsx("li",{className:"border-b py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:["ğŸ“…"," ",s.given_at||s.status]}),e.jsxs("div",{children:["ğŸ’µ ",s.amount," Ø¬.Ù…"]}),e.jsxs("div",{children:["ğŸ’¸ ",s.method," "]}),e.jsxs("div",{children:["ğŸ“ ",s.note]}),e.jsxs("div",{children:["ğŸ“"," ",((n=s.project)==null?void 0:n.name)||"Ø§Ø®Ø±Ù‰"]})]}),e.jsx("div",{children:e.jsx(L,{id:s.id,routeName:"admin.advance.delete"})})]})},a)})}):e.jsx("p",{className:"text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ù„ÙÙŠØ§Øª"})]},t.id))]}),_&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø¹Ù‡Ø¯Ø©"}),e.jsxs("select",{className:"w-full p-2 border rounded mb-4",value:v,onChange:t=>x(t.target.value),children:[e.jsx("option",{value:"",children:"-- Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© --"}),e.jsx("option",{value:"cash",children:"ÙƒØ§Ø´"}),e.jsx("option",{value:"wallet",children:"Ù…Ø­ÙØ¸Ø©"}),e.jsx("option",{value:"insta",children:"Ø§Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ"}),e.jsx("option",{value:"bank",children:"ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>c(!1),className:"bg-gray-200 px-4 py-2 rounded",children:"Ø¥Ù„ØºØ§Ø¡"}),e.jsx("button",{onClick:D,disabled:!v,className:"bg-green-500 text-white px-4 py-2 rounded",children:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©"})]})]})})]})}export{K as default};
