import{a as S,r as c,j as e,b as h}from"./app-010wRZBS.js";import{D as w}from"./DeleteButton-DZvfS_k5.js";import{A as k}from"./AuthenticatedLayout-wz4UIe47.js";import D from"./AdvancesList-Cc7Xwg8r.js";import"./HandelDelete-CbZVKxrk.js";import"./ApplicationLogo-CLCJLUPQ.js";import"./ResponsiveNavLink-dcmeS5bU.js";import"./transition-BmRszfgL.js";function z(){const{pendingAdvances:v,users:x}=S().props;console.log(v,"p");const[i,d]=c.useState(v),j=s=>{console.log(s),h.post(route("admin.advance.delete"),{id:s},{preserveScroll:!0,onSuccess:()=>{d(t=>t.filter(n=>n.id!==s)),l(!1),p(""),m(null)}})},[f,l]=c.useState(!1),[r,m]=c.useState(null),[u,p]=c.useState(""),g=s=>{m(s),l(!0)},b=()=>{const s=i.find(t=>t.id===r);h.post(route("admin.advance.status"),{advance_id:r,status:"accepted",amount:s.amount,note:s.note,payment_method:u},{preserveScroll:!0,onSuccess:()=>{d(t=>t.filter(n=>n.id!==r)),l(!1),p(""),m(null)}})},A=(s,t)=>{const n=i.find(a=>a.id===s);h.post(route("admin.advance.status"),{advance_id:s,status:t,amount:n.amount,note:n.note},{preserveScroll:!0,onSuccess:()=>{d(a=>a.filter(o=>o.id!==s))}})},y=(s,t,n)=>{d(a=>a.map((o,N)=>N===s?{...o,[t]:n}:o))};return e.jsxs(k,{children:[e.jsx(D,{advances:i,type:"pending",onDelete:j,onApprove:g,onReject:A,onUpdate:y,admin:!0}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"العهد المُستلمة"}),x.map(s=>e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl font-bold mb-2",children:s.name}),Array.isArray(s.advances)&&s.advances.length>0?e.jsx("ul",{className:"bg-white p-4 rounded shadow",children:s.advances.map((t,n)=>{var a;return e.jsx("li",{className:"border-b py-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{children:["📅 ",t.given_at||t.status]}),e.jsxs("div",{children:["💵 ",t.amount," ج.م"]}),e.jsxs("div",{children:["💸 ",t.method," "]}),e.jsxs("div",{children:["📝 ",t.note]}),e.jsxs("div",{children:["📝 ",((a=t.project)==null?void 0:a.name)||"اخرى"]})]}),e.jsx("div",{children:e.jsx(w,{id:t.id,routeName:"admin.advance.delete"})})]})},n)})}):e.jsx("p",{className:"text-gray-500",children:"لا توجد سلفيات"})]},s.id))]}),f&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"اختر طريقة تسليم العهدة"}),e.jsxs("select",{className:"w-full p-2 border rounded mb-4",value:u,onChange:s=>p(s.target.value),children:[e.jsx("option",{value:"",children:"-- اختر طريقة --"}),e.jsx("option",{value:"cash",children:"كاش"}),e.jsx("option",{value:"wallet",children:"محفظة"}),e.jsx("option",{value:"insta",children:"انستا باي"}),e.jsx("option",{value:"bank",children:"تحويل بنكي"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>l(!1),className:"bg-gray-200 px-4 py-2 rounded",children:"إلغاء"}),e.jsx("button",{onClick:b,disabled:!u,className:"bg-green-500 text-white px-4 py-2 rounded",children:"تأكيد الموافقة"})]})]})})]})}export{z as default};
