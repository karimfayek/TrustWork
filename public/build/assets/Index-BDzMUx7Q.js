import{r as n,c as N,j as e,L as k,b as C}from"./app-DcFActHb.js";import{A as S}from"./AuthenticatedLayout-DeyiMq6y.js";import"./ApplicationLogo-CGbuCU-C.js";import"./ResponsiveNavLink-CdA3L3TW.js";import"./transition-5aPAt0Qx.js";function E({visits:r,customers:p}){const[s,l]=n.useState(null),[a,m]=n.useState(r),i=new Date().getMonth()+1,d=new Date().getFullYear(),[c,j]=n.useState(i),[o,g]=n.useState(null),[x,v]=n.useState(d),[L,y]=n.useState(null),b=(t,h)=>{g(t);const w=a.filter(u=>u.customer_id===t.id);y(h),console.log(w),N.post(route("admin.visit.details",[t.id,c,x])).then(u=>{l(u.data[0].visits),console.log(s,"selectedItem")})},f=()=>{l(null),y(null),g(null),j(i),v(d)};return n.useEffect(()=>{s&&(console.log(s,"selectedItem"),N.post(route("admin.visit.details",[o.id,c,x])).then(t=>{l(t.data[0].visits),console.log(s,"selectedItem")}))},[c,x]),e.jsx(S,{children:e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:[" ","العملاء"]})}),e.jsxs("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{className:"text-right",children:[e.jsx("th",{className:"px-6 py-3 ",children:"اسم العميل"}),e.jsx("th",{className:"px-6 py-3 ",children:"عدد الزيارات"}),e.jsxs("th",{className:"px-6 py-3 ",children:[" ","عدد ما تم زيارات هذا لشهر"]}),e.jsx("th",{className:"px-6 py-3 ",children:"- "})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map(t=>{var h;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:t.name}),e.jsx("td",{className:"px-6 py-4",children:t.visits_nu}),e.jsx("td",{className:"px-6 py-4",children:(h=t.visits)==null?void 0:h.length}),e.jsx("td",{className:"px-6 py-4 space-x-2 rtl:space-x-reverse",children:e.jsx("button",{onClick:()=>b(t,"out"),className:"inline-block bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-md text-xs font-medium",children:"عرض الزيارات"})})]},t.id)})})]}),s&&e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex  justify-center z-50",onClick:t=>{t.stopPropagation()},children:[e.jsx("button",{onClick:()=>f(),className:"absolute top-4 left-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"bg-white rounded shadow-lg p-6 w-full",children:[e.jsxs("div",{className:"flex gap-2 items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["زيارات العميل ",o==null?void 0:o.name]}),e.jsxs("select",{className:"border border-gray-300 rounded-md p-2 w-28",onChange:t=>{j(t.target.value)},value:c,children:[e.jsx("option",{value:"1",children:"يناير"}),e.jsx("option",{value:"2",children:"فبراير"}),e.jsx("option",{value:"3",children:"مارس"}),e.jsx("option",{value:"4",children:"أبريل"}),e.jsx("option",{value:"5",children:"مايو"}),e.jsx("option",{value:"6",children:"يونيو"}),e.jsx("option",{value:"7",children:"يوليو"}),e.jsx("option",{value:"8",children:"أغسطس"}),e.jsx("option",{value:"9",children:"سبتمبر"}),e.jsx("option",{value:"10",children:"أكتوبر"}),e.jsx("option",{value:"11",children:"نوفمبر"}),e.jsx("option",{value:"12",children:"ديسمبر"})]}),e.jsxs("select",{className:"border border-gray-300 rounded-md p-2 w-24",onChange:t=>{v(t.target.value)},value:x,children:[e.jsx("option",{value:"2022",children:"2022"}),e.jsx("option",{value:"2023",children:"2023"}),e.jsx("option",{value:"2024",children:"2024"}),e.jsx("option",{value:"2025",children:"2025"}),e.jsx("option",{value:"2026",children:"2026"})]})]}),e.jsx(_,{visits:s})]})]})]})]})})}const _=({visits:r})=>{const p=(s,l)=>{s.preventDefault(),window.confirm("هل أنت متأكد أنك تريد الحذف  ")&&C.post(route("admin.visit.delete"),{id:l},{preserveScroll:!0})};return e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow",onClick:s=>s.stopPropagation(),children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{className:"text-right",children:[e.jsx("th",{className:"px-6 py-3 ",children:"العميل "}),e.jsx("th",{className:"px-6 py-3 ",children:"تسجيل الحضور"}),e.jsx("th",{className:"px-6 py-3 ",children:"الانصراف"}),e.jsx("th",{className:"px-6 py-3 ",children:"ملاحظات "}),e.jsx("th",{className:"px-6 py-3 ",children:" بواسطة"}),e.jsx("th",{className:"px-6 py-3 ",children:"- "})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[r.map(s=>{var l,a,m,i;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:(l=s.customer)==null?void 0:l.name}),e.jsx("td",{className:"px-6 py-4",children:(a=s.attendance)==null?void 0:a.check_in_time}),e.jsx("td",{className:"px-6 py-4",children:(m=s.attendance)==null?void 0:m.check_out_time}),e.jsx("td",{className:"px-6 py-4  max-w-[200px] truncate whitespace-nowrap overflow-hidden",children:s.notes}),e.jsx("td",{className:"px-6 py-4",children:(i=s.user)==null?void 0:i.name}),e.jsxs("td",{className:"px-6 py-4 space-x-2 rtl:space-x-reverse",children:[e.jsx(k,{href:route("admin.visits.show",s.id),className:"inline-block bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-md text-xs font-medium",children:"عرض"}),e.jsx("button",{onClick:d=>p(d,s.id),className:"inline-block bg-red-500 hover:bg-green-600 text-white px-3 py-1 rounded-md text-xs font-medium",children:"مسح"})]})]},s.id)}),r.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"لا توجد زيارات"})})]})]})})};export{_ as Visits,E as default};
