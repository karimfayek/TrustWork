import{r as u,j as e,R as m}from"./app-BMMUUtt3.js";import g from"./ReportLayout-r2-Uyri5.js";import"./AuthenticatedLayout-DX-eAp2J.js";import"./ApplicationLogo-DACMkUDR.js";import"./ResponsiveNavLink-F9ICIPml.js";import"./transition-S_Iy5K2R.js";function R({users:f,projects:c}){const[n,b]=u.useState("all");return e.jsx(g,{children:e.jsxs("div",{className:"bg-white max-w-6xl mx-auto px-4 py-6 space-y-10",children:[e.jsx("h1",{className:"text-2xl font-bold text-center",children:"تقرير العهد المالية"}),e.jsxs("div",{className:"mb-4 print:hidden",children:[e.jsx("label",{htmlFor:"projectFilter",className:"mr-2 font-semibold",children:"فلترة حسب المشروع:"}),e.jsxs("select",{id:"projectFilter",value:n,onChange:s=>b(s.target.value),className:"border px-2 py-1 rounded",children:[e.jsx("option",{value:"all",children:"الكل"}),c.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"العهدة المصروفة للمشروعات"}),e.jsx("div",{className:"overflow-x-auto border rounded shadow",children:e.jsxs("table",{className:"min-w-full table-auto text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"اسم المشروع"}),e.jsx("th",{className:"p-2 border",children:"التاريخ"}),e.jsx("th",{className:"p-2 border",children:"القيمة (جنيه)"}),e.jsx("th",{className:"p-2 border",children:" للموظف "})]})}),e.jsx("tbody",{children:c.filter(s=>n==="all"||s.id==n).map((s,o)=>{var a;let l=0,d=0;return e.jsxs(m.Fragment,{children:[e.jsx("tr",{className:"bg-gray-200",children:e.jsx("td",{colSpan:4,className:"font-bold p-2 text-2xl text-green-600",children:s.name})}),(a=s.advances)==null?void 0:a.map((r,x)=>{var h,p,j;const N=((h=r.expenses)==null?void 0:h.reduce((t,i)=>t+i.amount,0))||0;return l+=Number(r.amount),d+=Number(N),e.jsxs(m.Fragment,{children:[e.jsx("tr",{className:"bg-gray-100",children:e.jsxs("td",{className:"p-2 border font-semibold",colSpan:4,children:[x+1," - عهدة بتاريخ ",r.given_at," - بقيمة ",r.amount.toLocaleString()," جنيه - ",(p=r.user)==null?void 0:p.name]})}),((j=r.expenses)==null?void 0:j.length)>0?r.expenses.map((t,i)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 border"}),e.jsx("td",{className:"p-2 border",children:t.spent_at}),e.jsx("td",{className:"p-2 border",children:t.amount.toLocaleString()}),e.jsx("td",{className:"p-2 border",children:t.description})]},i)):e.jsx("tr",{children:e.jsx("td",{className:"p-2 border text-gray-500",colSpan:4,children:"لا توجد مصروفات لهذه العهدة"})})]},x)}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-2 border",colSpan:2,children:"إجمالي العهد"}),e.jsxs("td",{className:"p-2 border",colSpan:2,children:[l.toLocaleString()," جنيه"]})]}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-2 border",colSpan:2,children:"إجمالي المصروفات"}),e.jsxs("td",{className:"p-2 border",colSpan:2,children:[d.toLocaleString()," جنيه"]})]})]},o)})})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"المصروفات"}),e.jsx("div",{className:"overflow-x-auto border rounded shadow",children:e.jsxs("table",{className:"min-w-full table-auto text-sm text-right",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"اسم المشروع"}),e.jsx("th",{className:"p-2 border",children:"القيمة (جنيه)"}),e.jsx("th",{className:"p-2 border",children:"الموظف"}),e.jsx("th",{className:"p-2 border",children:"اضيفت بواسطه"}),e.jsx("th",{className:"p-2 border",children:"الإيصال"}),e.jsx("th",{className:"p-2 border",children:"التاريخ"})]})}),e.jsx("tbody",{children:c.map((s,o)=>e.jsx(m.Fragment,{children:s.advances.map((l,d)=>{var a,r;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-2 border",children:(a=l.project)==null?void 0:a.name}),e.jsx("td",{className:"p-2 border",children:l.amount.toLocaleString()}),e.jsx("td",{className:"p-2 border",children:l.user.name}),e.jsx("td",{className:"p-2 border",children:(r=l.by)==null?void 0:r.name}),e.jsxs("td",{className:"p-2 border",children:[" ",e.jsx("a",{className:"text-blue-700 underline",href:"/storage/"+l.file_path,children:" عرض"})]}),e.jsx("td",{className:"p-2 border",children:l.spent_at})]},d)})},o))})]})})]})]})})}export{R as default};
