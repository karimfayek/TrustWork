import{a as D,r,u as B,j as e,H as F,L as o,b as P}from"./app-jnlzYPnu.js";import{A as _}from"./AuthenticatedLayout-CFg_SBuZ.js";import{D as E}from"./DeleteButton-BvoSnSIJ.js";import{M as g,a as j,b as f,c as y,B as n}from"./ModalHeader-D6jGdhPL.js";import"./ApplicationLogo-Cq0qfxZU.js";import"./ResponsiveNavLink-mSvN2t_P.js";import"./transition-D0UWB7qs.js";import"./HandelDelete-CwoCuBxi.js";function Q({project:t}){var p;const i=D().props.auth.user,b={partial:"جاري ",final:" ختامي",supply:" جارى تشوينات",delevery:"  اذن تسليم",ir:" IR",mir:" MIR",qs:" QS"},[c,d]=r.useState(!1),[x,a]=r.useState(!1),[N,w]=r.useState(""),[l,v]=r.useState(""),{data:h,setData:k,post:M,processing:H}=B({file:null}),S=s=>{a(!0),w(s)},C=s=>{v(s),d(!0)},L=()=>{if(!h.file){alert("Please upload a file");return}const s=new FormData;s.append("file",h.file),M(route("extraction.file.upload",N),s,{forceFormData:!0,onSuccess:()=>{console.log("رفع الملف نجح"),a(!1)},onError:()=>{alert("حدث خطأ أثناء رفع الملف")}}),a(!1)},m=(s,u)=>{P.post(route("extraction.collected.set",u),{is_collected:s})};return e.jsxs(_,{children:[e.jsx(F,{title:"Admin Dashboard"}),x&&e.jsxs(g,{show:x,onClose:()=>a(!1),children:[e.jsx(j,{children:"   رفع مرفق "}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4 mt-4",children:e.jsx("input",{type:"file",onChange:s=>k("file",s.target.files[0]),className:"w-full",required:!0})})}),e.jsxs(y,{children:[e.jsx(n,{color:"green",onClick:L,children:"حفظ"}),e.jsx(n,{color:"gray",onClick:()=>a(!1),children:"إلغاء"})]})]}),c&&e.jsxs(g,{show:c,onClose:()=>d(!1),children:[e.jsx(j,{children:"   عرض مرفق "}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4 mt-4",children:l&&e.jsx(e.Fragment,{children:l.endsWith(".pdf")?e.jsx("iframe",{src:`/private-storage/${l}`,width:"100%",height:"500px",className:"border rounded"}):e.jsx("img",{src:`/private-storage/${l}`,alt:"preview",className:"max-w-full h-auto rounded shadow"})})})}),e.jsx(y,{children:e.jsx(n,{color:"gray",onClick:()=>d(!1),children:"إلغاء"})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800",children:["المستخلصات",e.jsx("br",{}),e.jsx("p",{className:"text-2xl text-gray-400",children:t.name})]}),e.jsx(o,{href:route("project.extractions.new",t.id),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-5 py-2 rounded-md shadow",children:"+ إنشاء مستخلص جديد"})]}),e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{className:"text-right",children:[e.jsx("th",{className:"px-6 py-3 ",children:" النوع"}),e.jsx("th",{className:"px-6 py-3 ",children:"رقم"}),e.jsx("th",{className:"px-6 py-3 ",children:"التاريخ"}),i.email!=="sherok@trustits.net"&&e.jsx(e.Fragment,{children:e.jsx("th",{className:"px-6 py-3 ",children:"صافى المستخلص"})}),e.jsx("th",{className:"px-6 py-3 ",children:" تم التحصيل ؟"}),e.jsx("th",{className:"px-6 py-3 ",children:" مرفق"}),e.jsx("th",{className:"px-6 py-3 ",children:"- "})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:(p=t.extractions)==null?void 0:p.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:b[s.type]}),e.jsx("td",{className:"px-6 py-4",children:s.partial_number}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:s.date}),i.email!=="sherok@trustits.net"&&e.jsx("td",{className:"px-6 py-4 text-gray-600",children:s.net_total}),s.is_collected?e.jsxs("td",{className:"px-6 py-4 text-green-600",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"green",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})}),e.jsx("button",{onClick:()=>m(!1,s.id),className:"ml-4 px-2 py-1 text-sm bg-gray-200 hover:bg-gray-300 rounded",children:"إلغاء التحصيل"})]}):e.jsxs("td",{className:"px-6 py-4 text-gray-600",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"red",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"red",className:"size-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),e.jsx("button",{onClick:()=>m(!0,s.id),className:"ml-4 px-2 py-1 text-sm bg-green-100 hover:bg-green-200 rounded",children:"تم التحصيل"})]}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:s.file?e.jsx("button",{onClick:()=>C(s.file),children:"عرض"}):"-"}),e.jsxs("td",{className:"px-6 py-4 space-x-2 rtl:space-x-reverse",children:[e.jsx("button",{onClick:u=>S(s.id),className:"inline-block bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-md text-xs font-medium",children:"مرفق"}),e.jsx(o,{href:route("extractions.preview",[t.id,s.id]),className:"inline-block bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-md text-xs font-medium",children:"عرض"}),e.jsx(o,{href:route("extractions.edit",[t.id,s.id]),className:"inline-block bg-blue-500 hover:bg-green-600 text-white px-3 py-1 rounded-md text-xs font-medium",children:"تعديل"}),i.email!=="sherok@trustits.net"&&e.jsx(E,{id:s.id,routeName:"extraction.delete"})]})]},s.id))})]})})]})]})}export{Q as default};
